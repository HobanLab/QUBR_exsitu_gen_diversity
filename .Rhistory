library(tidyverse)
library(ggplot2)
library(dplyr)
library(tibble)
library(lubridate)
library(chisq.posthoc.test)
setwd("..")
Today <- today()
Monitor1Date <- dmy("13/02/2022")
Monitor2Date <- dmy("20/01/2023")
Monitor3Date <- dmy("13/12/2023")
#imports Daniel's databases (2023 and 2024 tabs)
outplanted_seedlings23 <- read_csv("./data/Datos de Siembra en Ranchos_Actualizado_05_2024.xlsx - Datos_Campa침a_Seimbra_2023.csv")
outplanted_seedlings24 <- read_csv("./data/Datos de Siembra en Ranchos_Actualizado_05_2024.xlsx - Datos_Campa침a_Seimbra_2024.csv")
summary(outplanted_seedlings23)
summary(outplanted_seedlings24)
#combines data from 2023 and 2024 tabs
seedlings_combined <- bind_rows(outplanted_seedlings23, outplanted_seedlings24)
summary(seedlings_combined)
#renames columns to simplified English, differentiates seed origin and seedling planted region
seedlings_clean <- seedlings_combined%>%
rename(Name = 'Nombre')%>%
rename(Town = 'Localidad')%>%
rename(Ranch = 'Rancho, Lugar o Sitio')%>%
rename(Monitor1 = '13/02/2022 - Monitoreo 1')%>%
rename(Monitor2 = '20/01/2023 Monitoreo 2')%>%
rename(Monitor3 = '13/12/2023\nMonitoreo 3')%>%
rename(OriginReg = 'Procedencia semilla  (color)')%>%
rename(PlantedReg = 'Regi칩n')%>%
rename(DatePlanted = 'Fecha transplante')%>%
rename(YearCollected = 'A침o de colecta')%>%
rename(Observations = 'Observaciones')%>%
rename(Contact = 'Contacto')%>%
rename(PlantedIn = 'Sembrado en:')%>%
rename(Watered = 'Lluvia solida')%>%
rename(Monitor4 = 'Monitoreo 1 (__/__/__)')%>%
rename(OriginLabelAsh = 'Procedencia Etiqueta Ash Abril 2024')%>%
mutate(Monitor1=recode(Monitor1, 'Perdida' = 'Muerta'))%>%#reclass Perdida (poor) as Muerta (dead)
#calculate when a seedling died based on the last Monitoring date it was seen alive
add_column(DateDied = NA)%>%
mutate(DateDied = case_when(is.na(Monitor1) & is.na(Monitor2) & is.na(Monitor3) ~ DatePlanted,
Monitor1 == 'Nueva' & is.na(Monitor2) ~ DatePlanted,
Monitor1 == 'Nueva' & Monitor2 == 'Muerta' ~ DatePlanted,
Monitor1 == 'Muerta' ~ DatePlanted,
Monitor1 == 'Viva' & Monitor2 == 'Muerta' ~'13/02/2022',
Monitor2 == 'Viva' & is.na(Monitor3) ~ '20/01/2023',
Monitor1 == 'Viva' & is.na(Monitor2) ~ '13/02/2022',
Monitor2 == 'Nueva' & Monitor3 == 'Muerta' ~ DatePlanted,
Monitor2 == 'Nueva' & is.na(Monitor3) ~ DatePlanted,
Monitor2 == 'Viva' & Monitor3 == 'Muerta' ~ '20/01/2023'))%>%
add_column(Outcome = NA)%>%
#format date as DayMonthYear
add_column(TimeAlive = NA)%>%
add_column(RatioTimeAlive = NA)%>%
add_column(PotentialTimeAlive = NA)%>%
mutate(DateDied = dmy(DateDied))%>%
mutate(DatePlanted = dmy(DatePlanted))%>%
mutate(RatioTimeAlive = dmy(RatioTimeAlive))%>%
mutate(PotentialTimeAlive = dmy(PotentialTimeAlive))%>%
mutate(Outcome = case_when(Monitor1 == 'Muerta' | Monitor2 == 'Muerta' | Monitor3 == 'Muerta' ~ 'Dead',
Monitor3 == 'Nueva' | Monitor3 == 'Viva' ~ 'Alive',
Monitor2 == 'Nueva' & is.na(Monitor3) ~ 'Presumed Dead',
Monitor2 == 'Viva' & is.na(Monitor3) ~ 'Presumed Dead',
is.na(Monitor2) & is.na(Monitor3) ~ 'Presumed Dead',
is.na(Monitor1) & is.na(Monitor2) & is.na(Monitor3) ~ 'Presumed Dead'
))%>%
#calculate TimeAlive as difference between DatePlanted and DateDied
mutate(TimeAlive = DateDied - DatePlanted)%>%
mutate(PotentialTimeAlive = Today - DatePlanted)%>% #days since it was first planted
mutate(TimeAlive = case_when(Outcome == 'Alive' ~ (Today - DatePlanted),
Outcome == 'Dead' ~ (DateDied - DatePlanted),
Outcome == 'Presumed Dead' ~ (DateDied - DatePlanted)))%>%
mutate(RatioTimeAlive = (as.numeric(TimeAlive)) / (as.numeric(PotentialTimeAlive)))%>%
#removes rows for individuals handed out at Festival 2023
filter(!str_detect(Ranch, "Festival"))
#prioritize seedlings for visits while in Baja based on number of individuals at each ranch
priority_sites <- seedlings_clean%>%
filter(Outcome == 'Alive')%>%
group_by(PlantedReg, Ranch, N, W)%>%
summarise(n())
#export .csv to make Google Map of sites
#write.csv(priority_sites, "priority_sites.csv")
#increments of how old a seedling could be
df_age <-
data.frame("Days"=seq(0, 1200, 1), "DaysAlive" = NA)
View(df_age)
View(seedlings_clean)
#increments of how old a seedling could be
df_age <-
data.frame("Days"=seq(0, 1200, 1), "TotalTimeAlive" = NA)
View(df_age)
(i in 1:nrow(df_age)
1:nrow(df_age
1:nrow(df_age)
1:nrow(df_age)
i=1
Day <- df_age$Days[i]
df$Day
df$Days
df$Days[]
head(df)
df_age$Days
sum(Days <= df_age$DaysAlive)
sum(Day <= df_age$DaysAlive)
sum(Day <= seedlings_clean$TimeAlive)
?summarise
?sum
sum(Day <= seedlings_clean$TimeAlive, na.rm = TRUE)
Num_seedlings_alive <- sum(Day <= seedlings_clean$TimeAlive, na.rm = TRUE)
for (i in 1:nrow(df_age)) {
Day <- df_age$Days[i]
Num_seedlings_alive <- sum(Day <= seedlings_clean$TimeAlive, na.rm = TRUE)
}
View(df_age)
Day <- df_age$Days[i]
#increments of how old a seedling could be
df_age <-
data.frame("Days"=seq(0, 1200, 1), "TotalTimeAlive" = NA)
i in 1:nrow(df_age
#increments of how old a seedling could be
df_age <-
data.frame("Days"=seq(0, 1200, 1), "TotalAlive" = NA)
#for loop
for (i in 1:nrow(df_age)) {
Day <- df_age$Days[i]
Num_seedlings_alive <- sum(Day <= seedlings_clean$TimeAlive, na.rm = TRUE)
}
#increments of how old a seedling could be
df_age <-
data.frame("Days"=seq(0, 1200, 1), "Num_seedlings_alive" = NA)
#df_age$Days is a vector (one column in this df)
Num_seedlings_alive <- sum(Day <= seedlings_clean$TimeAlive, na.rm = TRUE)
#for loop
for (i in 1:nrow(df_age)) {
Day <- df_age$Days[i] #df_age$Days is a vector (one column in this df)
Num_seedlings_alive <- sum(Day <= seedlings_clean$TimeAlive, na.rm = TRUE) #Day is a temporary object that holds the output of the day we are on in the iterative loop
}
df_age
Num_seedlings_alive[i, ] <- sum(Day <= seedlings_clean$TimeAlive, na.rm = TRUE) #Day is a temporary object that holds the output of the day we are on in the iterative loop
Num_seedlings_alive <- sum(Day <= seedlings_clean$TimeAlive, na.rm = TRUE) #Day is a temporary object that holds the output of the day we are on in the iterative loop
df_age$Num_seedlings_alive[i] <- sum(Day <= seedlings_clean$TimeAlive, na.rm = TRUE) #Day is a temporary object that holds the output of the day we are on in the iterative loop
View(df_age)
df_age$Num_seedlings_alive[i] <- sum(Day[i] <= seedlings_clean$TimeAlive, na.rm = TRUE) #Day is a temporary object that holds the output of the day we are on in the iterative loop
View(df_age)
Day <- df_age$Days[i] #df_age$Days is a vector (one column in this df)
View(df_age)
#increments of how old a seedling could be
df_age <-
data.frame("Days"=seq(0, 1200, 1), "TotalAlive" = NA)
View(df_age)
df_age$TotalAlive[i] <- paste0(Num_seedlings_alive)
Num_seedlings_alive <- sum(Day <= seedlings_clean$TimeAlive, na.rm = TRUE) #Day is a temporary object that holds the output of the day we are on in the iterative loop
df_age$TotalAlive[i] <- paste0(Num_seedlings_alive)
View(df_age)
Num_seedlings_alive <- sum(Day <= seedlings_clean$TimeAlive, na.rm = TRUE) #Day is a temporary object that holds the output of the day we are on in the iterative loop
df_age$TotalAlive[i] <- paste0(Num_seedlings_alive)
for (i in 1:nrow(df_age)) {
Day <- df_age$Days[i] #df_age$Days is a vector (one column in this df)
Num_seedlings_alive <- sum(Day <= seedlings_clean$TimeAlive, na.rm = TRUE) #Day is a temporary object that holds the output of the day we are on in the iterative loop
df_age$TotalAlive[i] <- paste0(Num_seedlings_alive)
}
df_age%>%
ggplot() +
geom_histogram(aes(x = Days)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(x = Days, y = TotalAlive)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(y = TotalAlive)) +
theme_classic()
?geom_histogram
seedlings_clean%>%
ggplot() +
geom_histogram(aes(x = TimeAlive)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(y = Days)) +
theme_classic()
seedlings_clean%>%
ggplot() +
geom_histogram(aes(x = TimeAlive)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(x = Days)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(x = TotalAlive)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(y = TotalAlive)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(x = Days)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_bar(aes(x = TotalAlive, y = Days)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_hist(aes(x = TotalAlive, y = Days)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(x = TotalAlive, y = Days)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot(x = Days) +
geom_histogram(aes(y = TotalAlive)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot(x = Days) +
geom_histogram() +
theme_classic()
seedlings_clean%>%
ggplot() +
geom_histogram(aes(x = TimeAlive)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(x = Days)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(y = TotalAlive)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(x = Days)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_column(aes(x = Days, y = TotalAlive)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_col(aes(x = Days, y = TotalAlive)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_col(aes(y = Days, x = TotalAlive)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_line(aes(x = Days, y = TotalAlive))) +
#plot survivorship curve
df_age%>%
ggplot() +
geom_line(aes(x = Days, y = TotalAlive)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_bar(aes(x = Days)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(x = Days)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(y = TotalAlive)) +
theme_classic()
df_age
#plot survivorship curve
df_age%>%
ggplot() +
geom_col(aes(x = Days, y = TotalAlive)) +
theme_classic()
geom_col() +
#plot survivorship curve
df_age%>%
ggplot(aes(x = Days, y = TotalAlive)) +
geom_col() +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_col(aes(x = Days, y = TotalAlive)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_col(aes(y = TotalAlive)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_col(aes(x = TotalAlive)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_col(aes(x = Days)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_col(aes(x = Days, y = Num_seedlings_alive)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_col(aes(x = Days, y = TotalAlive)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(x = Days)) +
theme_classic()
?geom_histogram
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(x = Days, binwidth = NULL)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(x = Days, binwidth = 10)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(x = Days)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(x = Days), binwidth = 0.5) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(x = Days), binwidth = 5) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(x = Days), binwidth = 2) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(x = Days), binwidth = 50) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(x = Days), binwidth = 500) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(x = Days), binwidth = 20) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(x = TotalAlive), binwidth = 20) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(x = Days), binwidth = 20) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(x = Days), binwidth = 1) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot() +
geom_histogram(aes(x = Days, y = TotalAlive), binwidth = 1) +
theme_classic()
geom_histogram(aes(binwidth = 1) +
#plot survivorship curve
df_age%>%
df_age%>%
ggplot(aes(x = Days, y = TotalAlive)) +
geom_histogram(aes(binwidth = 1) +
theme_classic()
#plot survivorship curve
df_age%>%
df_age%>%
ggplot(aes(x = Days, y = TotalAlive)) +
geom_histogram(aes(binwidth = 1)) +
theme_classic()
#plot survivorship curve
df_age%>%
ggplot(aes(x = Days, y = TotalAlive)) +
geom_histogram(binwidth = 1) +
theme_classic()
View(seedlings_clean)
